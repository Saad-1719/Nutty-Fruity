<%- include('../partials/head') %>
  <% if (!userId) { %>
    <%- include('../partials/headerMain') %>

      <% } else { %> <%- include('../partials/headerAdmin') %>
          <% } %>

            <link rel="stylesheet" href="/css/style.css">

            <style>
              .main-dashboard {
                display: flex;
              }

              .sidebar {
                width: 200px;
                background-color: #004E64;
                color: white;
                min-height: 100vh;
                padding: 20px;
                box-sizing: border-box;
              }

              .sidebar ul {
                list-style: none;
                padding: 0;
                border-radius: 12px;
              }

              .sidebar ul li {
                margin: 20px 0;
                border-radius: 12px;
              }

              .sidebar ul li a {
                color: white;
                text-decoration: none;
                font-weight: bold;
                display: block;
                padding: 11px;
                border-radius: 12px;
                text-align: center;
              }

              .sidebar ul li a:hover {
                background-color: white;
                color: black;
              }

              .sidebar ul li a.active {
                background-color: white;
                color: black;
              }

              .sidebar ul li a:focus {
                background-color: white;
                color: black;
              }

              .main-content {
                flex-grow: 1;
                padding: 20px;
                box-sizing: border-box;
              }

              .dashboard {
                display: none;
                padding: 20px;
                border-radius: 8px;
                border: 2px solid rgba(255,255,255,0.18);
                background-color: #fff6;
                backdrop-filter: blur(30px);
                box-shadow: 0 0px 0px  0px rgba(227, 228, 237, 0.37);

              }

              .heading-container {
                display: block;
                justify-content: center;
                margin-top: 30px;
              }

              .result-class {
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 10px;
                margin: 10px;
              }

              .result {
                padding: 20px;
                border: 2px solid #023047;
                min-width: 300px;
                text-align: center;
                margin: 20px;
                border-radius: 5px;
              }

              form {
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 10px;
                flex-direction: column;
              }

              strong {
                font-size: 22px;
              }

              .table-container {
                display: flex;
                padding: 20px;
                /* border: 2px solid #9FFFCB; */
                min-width: 300px;
                text-align: center;
                margin: 20px;
                border-radius: 5px;
                align-items: center;
                justify-content: center;
              }


              th,
              td {
                min-width: 20vw;
                padding: 10px;
                border-color: black;
                border-style: solid;
                border-width: 1px;

              }

              .dashboard h2 {
                text-align: center;
              }

              .date_container {
                display: flex;
                align-items: center;
                justify-content: center;
              }
            </style>
            <section class="main-dashboard">

              <div class="sidebar">
                <ul>
                  <li><a href="#" onclick="showDashboard('dashboard1')">Stock</a></li>
                  <li><a href="#" onclick="showDashboard('dashboard2')">Total Sales</a></li>
                  <li><a href="#" onclick="showDashboard('dashboard3')">Top Selling Product</a></li>
                  <form action="/logout" method="POST">
                    <button type="submit" class="btn btn-danger">
                      Logout&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em"
                        viewBox="0 0 24 24">
                        <path fill="currentColor"
                          d="M14.945 1.25c-1.367 0-2.47 0-3.337.117c-.9.12-1.658.38-2.26.981c-.524.525-.79 1.17-.929 1.928c-.135.737-.161 1.638-.167 2.72a.75.75 0 0 0 1.5.008c.006-1.093.034-1.868.142-2.457c.105-.566.272-.895.515-1.138c.277-.277.666-.457 1.4-.556c.755-.101 1.756-.103 3.191-.103h1c1.436 0 2.437.002 3.192.103c.734.099 1.122.28 1.4.556c.276.277.456.665.555 1.4c.102.754.103 1.756.103 3.191v8c0 1.435-.001 2.436-.103 3.192c-.099.734-.279 1.122-.556 1.399c-.277.277-.665.457-1.399.556c-.755.101-1.756.103-3.192.103h-1c-1.435 0-2.436-.002-3.192-.103c-.733-.099-1.122-.28-1.399-.556c-.243-.244-.41-.572-.515-1.138c-.108-.589-.136-1.364-.142-2.457a.75.75 0 1 0-1.5.008c.006 1.082.032 1.983.167 2.72c.14.758.405 1.403.93 1.928c.601.602 1.36.86 2.26.982c.866.116 1.969.116 3.336.116h1.11c1.368 0 2.47 0 3.337-.116c.9-.122 1.658-.38 2.26-.982c.602-.602.86-1.36.982-2.26c.116-.867.116-1.97.116-3.337v-8.11c0-1.367 0-2.47-.116-3.337c-.121-.9-.38-1.658-.982-2.26c-.602-.602-1.36-.86-2.26-.981c-.867-.117-1.97-.117-3.337-.117z" />
                        <path fill="currentColor"
                          d="M15 11.25a.75.75 0 0 1 0 1.5H4.027l1.961 1.68a.75.75 0 1 1-.976 1.14l-3.5-3a.75.75 0 0 1 0-1.14l3.5-3a.75.75 0 1 1 .976 1.14l-1.96 1.68z" />
                      </svg>
                    </button>
                  </form>
                  <!-- <li><a href="#" onclick="showDashboard('dashboard4')">Current Stock Level</a></li> -->
                </ul>
              </div>
              <div class="main-content">

                <div id="dashboard1" class="dashboard">
                  <h2>Stock</h2>
                  <div class="table-container">

                    <table>

                      <tr>
                        <th>Name</th>
                        <th>Total Quantity</th>
                        <th>Available Quantity</th>
                      </tr>
                      <% stocks.forEach((stock)=>{ %>
                        <tr>
                          <td>
                            <%= stock.name %>
                          </td>
                          <td>
                            <%= stock.total_quantity %>
                          </td>
                          <td>
                            <%= stock.remaining_quantity %>
                          </td>
                        </tr>

                        <% }) %>
                    </table>

                  </div>
                </div>
                <div id="dashboard2" class="dashboard">
                  <h2>Sales</h2>
                  <!-- <p>This is the content of Dashboard 1.</p> -->
                  <form action="/admin" method="post" id="submitForm">
                    <label for="date_sub" style="font-size: 20px;">Enter Date to view total sales</label>
                    <input type="date" id="date_sub" name="date_sub" style="padding: 10px; margin: 10px; width: 250px;">
                    <button type="submit" class="btn btn-primary">Submit</button>
                  </form>
                  <div class="date_container">

                    <b>Date: <%= date %></b>
                  </div>
                  <div class="result-class">
                    <div class="result">
                      <strong>Total Sales</strong>
                      <p>
                        <b>
                          Amount:
                        </b>
                        <%= totalSales %> PKR
                      </p>
                    </div>
                    <div class="result">
                      <strong>Average Sales</strong>
                      <p>
                        <b>
                          Amount:
                        </b>
                        <%= averageSales %> PKR
                      </p>
                    </div>
                    <div class="result">
                      <strong>No of Orders</strong>
                      <p>
                        <b>
                          Numbers:
                        </b>
                        <%= placedOrders %>
                      </p>
                    </div>
                  </div>
                  <div class="result">
                    <strong>Product Sale per day</strong>
                    <div class="table-container" style="border: none;">
                      <table>
                        <tr>
                          <th>Name</th>
                          <th>Quantity</th>
                        </tr>
                        <% if (Array.isArray(per_day_item) && per_day_item.length> 0) { %>
                          <% per_day_item.forEach((items)=> { %>
                            <tr>
                              <td>
                                <%= items.name %>
                              </td>
                              <td>
                                <%= items.quantity_sold %>
                              </td>
                            </tr>
                            <% }) %>
                              <% } else { %>
                                <tr>
                                  <td colspan="2">No items found.</td>
                                </tr>
                                <% } %>
                      </table>
                    </div>
                  </div>
                </div>
                <div id="dashboard3" class="dashboard">
                  <h2>Top Seller</h2>
                  <div class="table-container">


                    <table>

                      <tr>
                        <th>Name</th>
                        <th>Quantity</th>
                      </tr>
                      <% if (Array.isArray(top_seller) && top_seller.length> 0) { %>
                      <% top_seller.forEach((items)=>{ %>
                        <tr>
                          <td>
                            <%= items.name %>
                          </td>
                          <td>
                            <%= items.quantity_sold %>
                          </td>
                        </tr>

                        <% }) %>
                        <% } else { %>
                          <tr>
                            <td colspan="2">No items found.</td>
                          </tr>
                          <% } %>
                    </table>
                  </div>
                  </div>
                </div>
              </div>
            </section>

            <script>
              function showDashboard(dashboardId) {
                // Hide all dashboards
                var dashboards = document.querySelectorAll('.dashboard');
                dashboards.forEach(function (dashboard) {
                  dashboard.style.display = 'none';
                });

                // Show the selected dashboard
                var selectedDashboard = document.getElementById(dashboardId);
                if (selectedDashboard)
                {
                  selectedDashboard.style.display = 'block';
                }
                // Save the selected dashboard to local storage
                localStorage.setItem('selectedDashboard', dashboardId);
              }

              // Optionally, show the first dashboard by default
              document.addEventListener('DOMContentLoaded', function () {
                // showDashboard('dashboard1');
                var savedDashboard = localStorage.getItem('selectedDashboard') || 'dashboard1';
                showDashboard(savedDashboard);
              });


            </script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
            <script src="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
            <%- include('../partials/footer') %>